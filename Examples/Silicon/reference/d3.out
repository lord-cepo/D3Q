
     Program D3_toten v.6.4 starts on 25Feb2019 at 11:51: 4 

     This program is part of the open-source Quantum ESPRESSO suite
     for quantum simulation of materials; please cite
         "P. Giannozzi et al., J. Phys.:Condens. Matter 21 395502 (2009);
         "P. Giannozzi et al., J. Phys.:Condens. Matter 29 465901 (2017);
          URL http://www.quantum-espresso.org", 
     in publications or presentations arising from this work. More details at
     http://www.quantum-espresso.org/quote

     Parallel version (MPI), running on     1 processors

     MPI processes distributed on     1 nodes
      ___  ____   __    ____  ____  ____  _  _  ___    ____  ___  
     / __)(_  _) /__\  (  _ \(_  _)(_  _)( \( )/ __)  (  _ \(__ ) 
     \__ \  )(  /(__)\  )   /  )(   _)(_  )  (( (_-.   )(_) )(_ \ 
     (___/ (__)(__)(__)(_)\_) (__) (____)(_)\_)\___/  (____/(___/ 

     Waiting for input...
     _____________ input start _____________
&INPUTD3Q
 ETHR_PH=  1.0000000000000001E-009,
 AMASS= 10*0.0000000000000000       ,
 PREFIX="silicon                                                                                                                                                                                                                                                         ",
 OUTDIR="./tmp                                                                                                                                                                                                                                                           ",
 FILDRHO_DIR="FILDRHO                                                                                                                                                                                                                                                         ",
 D3DIR="                                                                                                                                                                                                                                                                ",
 FILD3DYN="FILD3DYN/anh                                                    ",
 FILDRHO="auto:drho                                                                                                                                                                                                                                                       ",
 FILD1RHO="                                                                                                                                                                                                                                                                ",
 FILD2RHO="                                                                                                                                                                                                                                                                ",
 FILD3RHO="                                                                                                                                                                                                                                                                ",
 ISTOP=0          ,
 MODE="full                                                                                                                                                                                                                                                            ",
 IVERBOSITY=0          ,
 FIRST=-1         ,
 LAST=-1         ,
 STEP=1          ,
 OFFSET=0          ,
 SAFE_IO=F,
 RESTART=F,
 MAX_TIME= -1.0000000000000000     ,
 MAX_SECONDS=-1         ,
 PRINT_STAR=T,
 PRINT_PERM=F,
 PRINT_TREV=T,
 D3_NK1=-1         ,
 D3_NK2=-1         ,
 D3_NK3=-1         ,
 D3_K1=-1         ,
 D3_K2=-1         ,
 D3_K3=-1         ,
 D3_DEGAUSS= -1.0000000000000000     ,
 /
     _____________  input end  _____________
     Doing grid dispersion calculation
     Checking for debug instructions.

     Reading data from directory:
     ./tmp/silicon.save/

     IMPORTANT: XC functional enforced from input :
     Exchange-correlation      = PZ ( 1  1  0  0 0 0)
     Any further DFT definition will be discarded
     Please, verify this is what you really want


     G-vector sticks info
     --------------------
     sticks:   dense  smooth     PW     G-vecs:    dense   smooth      PW
     Sum         349     349    109                 4279     4279     749

     Message from routine kpoint_grid:
     ATTENTION: skip check of k-points equivalence
     Looking for irreducible triplets out of       24 possibilities:
           1:   (  0.0000  0.0000  0.0000 )   (  0.0000  0.0000  0.0000 )   ( -0.0000 -0.0000 -0.0000 )   -->_Q1.0_0_0_Q2.0_0_0_Q3.0_0_0
           2:   (  0.0000  0.0000  0.0000 )   (  0.5000 -0.5000  0.5000 )   ( -0.5000  0.5000 -0.5000 )   -->_Q1.0_0_0_Q2.0_0_-1o2_Q3.0_0_1o2
           3:   (  0.0000  0.0000  0.0000 )   (  0.0000 -1.0000  0.0000 )   ( -0.0000  1.0000 -0.0000 )   -->_Q1.0_0_0_Q2.0_-1o2_-1o2_Q3.0_1o2_1o2
           4:   (  0.5000 -0.5000  0.5000 )   ( -0.5000 -0.5000 -0.5000 )   (  0.0000  1.0000  0.0000 )   -->_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2
           5:   (  0.0000 -1.0000  0.0000 )   (  1.0000  0.0000  0.0000 )   ( -1.0000  1.0000 -0.0000 )   -->_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1
     IRREDUCIBLE NUMBER OF TRIPLETS TO COMPUTE:   5

     ===================================================
     =             Starting D3 calculation             =
     ===================================================
     =     triplet    1 (    1 of    5,   0% done)     =
     ===================================================
     =    q1 = (    0.000000   0.000000   0.000000 )   =
     =    q2 = (    0.000000   0.000000   0.000000 )   =
     =    q3 = (   -0.000000  -0.000000  -0.000000 )   =
     ===================================================
     Temporary directory set to:
       ./tmp//D3_Q1.0_0_0_Q2.0_0_0_Q3.0_0_0/
     SCF rho copied to D3 tmp dir
     Scanning for fildrho files...
         --> drho file for q1 found as 'drho.0_0_0'
         --> drho file for q2 found as 'drho.0_0_0'
         --> drho file for q3 found as 'drho.0_0_0'
     ================== setup started ==================
     Special cases for qs:
       q1 = G  , q2 , -q2, q3 , -q3
       q2 = G  , q1 , -q1, q3 , -q3
       q3 = G  , q1 , -q1, q2 , -q2
       Symmetry operations:
         q1:  0  TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT
         q2:  0  TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT
         q3:  0  TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT
       Symmetry common to all q vectors:
             TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT
         -->48 symmetry operation(s) have been found
 REMARK: q -> -q symmetry yet unsupported in d3q.x
         individual q --> -q operations: FFF
       Reading patterns and q-point for q1
       Reading patterns and q-point for q2
       Reading patterns and q-point for q3
       Symmetry information for Gamma associated with q1

     Symmetry analysis done
     =================== setup done ====================



     =============== run_nscf_d3 start

     Starting non-scf calculation of ground state wavefunctions.
       * has time reversal symmetry.
     Total number of kpoints:
       --> after reducing symmetry:     8
       --> after including k+/-q_i (kunit):     8 (1)

     --> output from 'electrons' appended to ./tmp//nscf_Q1.0_0_0_Q2.0_0_0_Q3.0_0_0.out

     Writing output data file silicon.save/

     =============== run_nscf_d3 done

     =============== allocate_d3 start

     =============== allocate_d3 done

     ============== openfile_drho start

     Opening files of charge density derivative.
         q1 --> opening: drho.0_0_0
         q2 --> not opening: drho.0_0_0
         q3 --> not opening: drho.0_0_0

     ============== openfile_drho done

     ================ openfild3 start

     ================ openfild3 done
     u: 301   recl:     27648   ext:                     drho.0_0_0   tmp: FILDRHO/
     u:  20   recl:      4352   ext:                            wfc   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_0_Q3.0_0_0/
     u:5011   recl:      4352   ext:                        dq1pq1.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_0_Q3.0_0_0/
     u:6011   recl:        32   ext:                      pdvq1pq1.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_0_Q3.0_0_0/

     ================= d3_init start
     alpha_pv:      1.7772

     ================= d3_init done

     ========== d3_check_permutations start
     Looking for equivalent permutations of q vectors
       Permutation 1 (123) has to be computed explicitly
       Permutation 2 (132) can be obtained from 1 (123) 
       Permutation 3 (213) can be obtained from 1 (123) 
       Permutation 4 (231) can be obtained from 1 (123) 
       Permutation 5 (312) can be obtained from 1 (123) 
       Permutation 6 (321) can be obtained from 1 (123) 
     1 inequivalent permutations were found

     ========== d3_check_permutations done
     D3_toten     :      0.44s CPU      0.44s WALL


     ================== add core start

     Adding derivative of core charge
     d3_add_rho_core   cpu time:     0.44 sec    Total time:        0.44 sec

     ================== add core done

     ===================================================
     = Nscf calculation of the perturbed wavefunctions =
     ===================================================

     Computing P_c^q1 |d^q1 psi_k>
         pert=    1     time taken/total=      0.5/      0.9 secs     av.it.  16.6
         pert=    2     time taken/total=      0.5/      1.5 secs     av.it.  16.7

     Skipping P_c^G |d^q1 psi_k-q1>
       --> already done as P_c^q1 |d^q1 psi_k+q1>

     Skipping P_c^-q1 |d^-q1 psi_k>
       --> already done as P_c^q1 |d^q1 psi_k+q1>

     Skipping P_c^G |d^-q1 psi_k+q1>
       --> already done as P_c^q1 |d^q1 psi_k+q1>

     Skipping <psi_k+q2 |d^q2V| psi_k>
       --> already done as <psi_k+q1 |d^q1V| psi_k+q1>

     Skipping <psi_k |d^q2V| psi_k-q2>
       --> already done as <psi_k+q1 |d^q1V| psi_k+q1>

     Skipping P_c^-q2 |d^-q2 psi_k>
       --> already done as P_c^q1 |d^q1 psi_k+q1>

     Skipping P_c^G |d^-q2 psi_k+q2>
       --> already done as P_c^q1 |d^q1 psi_k+q1>

     Skipping <psi_k+q3 |d^q3V| psi_k>
       --> already done as <psi_k+q1 |d^q1V| psi_k+q1>

     Skipping <psi_k |d^q3V| psi_k-q3>
       --> already done as <psi_k+q1 |d^q1V| psi_k+q1>

     Skipping P_c^-q3 |d^-q3 psi_k>
       --> already done as P_c^q1 |d^q1 psi_k+q1>

     Skipping P_c^G |d^-q3 psi_k+q3>
       --> already done as P_c^q1 |d^q1 psi_k+q1>

     Skipping <psi_k-q3 |d^q1V| psi_k+q2>
       --> already done as <psi_k+q1 |d^q1V| psi_k+q1>

     Skipping <psi_k-q2 |d^q1V| psi_k+q3>
       --> already done as <psi_k+q1 |d^q1V| psi_k+q1>

     Skipping <psi_k-q3 |d^q2V| psi_k+q1>
       --> already done as <psi_k+q1 |d^q1V| psi_k+q1>

     Skipping <psi_k-q1 |d^q2V| psi_k+q3>
       --> already done as <psi_k+q1 |d^q1V| psi_k+q1>

     Skipping <psi_k-q2 |d^q3V| psi_k+q1>
       --> already done as <psi_k+q1 |d^q1V| psi_k+q1>

     Skipping <psi_k-q1 |d^q3V| psi_k+q2>
       --> already done as <psi_k+q1 |d^q1V| psi_k+q1>


     generate_dwfc   cpu time:     1.02 sec    Total time:        1.46 sec

     ================== nscf dpsi done =================


     ================== precomp start

     Pre-computing < Pc dpsi_(k+X)/du(-X)| dH/du(Y) | psi_k-Y >
     gen_dpsi1dv2psi     cpu time:     0.00 sec    Total time:        1.46 sec

     ================== precomp done

     ================== dpdvdp start

     Calculating the matrix elements <dpsi |dH |dpsi>
       <d^-q3 psi_k|d^q2  V|d^q1  psi_k>
     dpsi1dv2dpsi3 cpu time:     0.36 sec    Total time:        1.82 sec

     ================== dpdvdp done

     ================== dpdpdv start

     Calculating the matrix elements <dpsi|dpsi>< psi|dH|psi> 
       <d_-q3 psi_k+q3| d_q1 psi_k-q1> <psi_k-q1|d_q2 H|psi_k+q3>
     dpsi1dpsi2dv3 cpu time:     0.01 sec    Total time:        1.82 sec

     ================== dpdpdv done

     ================== dpd2v start

     Calculating the matrix elements <psi |d^2 v |dpsi>
       <d_q1 psi_k| d^2_(q2,q3) V|psi_k>
     drhod2v       cpu time:     0.07 sec    Total time:        1.90 sec

     ================== dpd2v done

     =================== rho d3v start =================


     Calculating the matrix elements <psi |d^3v |psi>
     d3vrho        cpu time:     0.05 sec    Total time:        1.94 sec

     =================== rho d3v done ==================


     ================== ewald start

     Calculating the Ewald contribution

     Alpha used in Ewald sum =   1.01
     d3ionq        cpu time:     0.08 sec    Total time:        2.03 sec

     ================== ewald done

     ================ exc contrib start

     Calculating the exchange-correlation contribution
     d3_exc        cpu time:     0.02 sec    Total time:        2.05 sec

     ================ exc contrib done

     =============== computing D3 start

     Symmetrizing and writing the tensor to disc

     CALLing d3matrix
       * imposing hermiticity on idx 2,3
       * imposing hermiticity on idx 1,3
       * imposing hermiticity on idx 1,2
       * symmetrizing with 48 sym.ops.
       point #  1  : star #  1  perm #  1 ( 1 2 3 )
      -->FILD3DYN/anh_Q1.0_0_0_Q2.0_0_0_Q3.0_0_0
     d3matrix      cpu time:     0.01 sec    Total time:        2.06 sec

     =============== computing D3 done

     ================== cleanup start

     D3TOTEN      :      1.98s CPU      2.06s WALL (       1 calls)
     --> wfc and dwfc
     nscf         :      0.22s CPU      0.22s WALL (       1 calls)
     generate_dwf :      0.96s CPU      1.02s WALL (       1 calls)
     --> matrix elements
     dpsi1dv2dpsi :      0.35s CPU      0.36s WALL (       1 calls)
     dpsi1dpsi2dv :      0.00s CPU      0.01s WALL (       1 calls)
     dq1rhodq23v  :      0.07s CPU      0.07s WALL (       1 calls)
     rhodq123v    :      0.05s CPU      0.05s WALL (       1 calls)
     d3ionq       :      0.08s CPU      0.08s WALL (       1 calls)
     d3_exc       :      0.02s CPU      0.02s WALL (       1 calls)
     d3matrix     :      0.01s CPU      0.01s WALL (       1 calls)
     --> total I/O
     davcio       :      0.01s CPU      0.02s WALL (    2436 calls)

     ================== cleanup done

     ===================================================
     =             Starting D3 calculation             =
     ===================================================
     =     triplet    2 (    2 of    5,  20% done)     =
     ===================================================
     =    q1 = (    0.000000   0.000000   0.000000 )   =
     =    q2 = (    0.500000  -0.500000   0.500000 )   =
     =    q3 = (   -0.500000   0.500000  -0.500000 )   =
     ===================================================
     Temporary directory set to:
       ./tmp//D3_Q1.0_0_0_Q2.0_0_-1o2_Q3.0_0_1o2/
     SCF rho copied to D3 tmp dir
     Scanning for fildrho files...
         --> drho file for q1 found as 'drho.0_0_0'
         --> drho file for q2 found as 'drho.0_0_-1o2'
         --> drho file for q3 found as 'drho.0_0_-1o2'
     ================== setup started ==================
     Special cases for qs:
       q1 = G
       q2 = -q3
       q3 = -q2
       Symmetry operations:
         q1: 48  TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT
         q2: 48  TFFFTFFFFTFFTFFFFFFTFTFFTFFFTFFFFTFFTFFFFFFTFTFF
         q3: 48  TFFFTFFFFTFFTFFFFFFTFTFFTFFFTFFFFTFFTFFFFFFTFTFF
       Symmetry common to all q vectors:
             TFFFTFFFFTFFTFFFFFFTFTFFTFFFTFFFFTFFTFFFFFFTFTFF
         -->12 symmetry operation(s) have been found
 REMARK: q -> -q symmetry yet unsupported in d3q.x
         individual q --> -q operations: FFF
       Reading patterns and q-point for q1
       Reading patterns and q-point for q2
       Reading patterns and q-point for q3
         --> taking c.c. of patterns for q3
       Symmetry information for Gamma associated with q1

     Symmetry analysis done
     =================== setup done ====================



     =============== run_nscf_d3 start

     Starting non-scf calculation of ground state wavefunctions.

     WARNING: check_stop already initialized
       * has time reversal symmetry.
     Total number of kpoints:
       --> after reducing symmetry:    13
       --> after including k+/-q_i (kunit):    39 (3)

     --> output from 'electrons' appended to ./tmp//nscf_Q1.0_0_0_Q2.0_0_-1o2_Q3.0_0_1o2.out

     Writing output data file silicon.save/

     =============== run_nscf_d3 done

     =============== allocate_d3 start

     =============== allocate_d3 done

     ============== openfile_drho start

     Opening files of charge density derivative.
         q1 --> opening: drho.0_0_0
         q2 --> opening: drho.0_0_-1o2
         q3 --> not opening: drho.0_0_-1o2

     ============== openfile_drho done

     ================ openfild3 start

     ================ openfild3 done
     u: 301   recl:     27648   ext:                     drho.0_0_0   tmp: FILDRHO/
     u: 302   recl:     27648   ext:                  drho.0_0_-1o2   tmp: FILDRHO/
     u:  20   recl:      4352   ext:                            wfc   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_-1o2_Q3.0_0_1o2/
     u:5022   recl:      4352   ext:                        dq2pq2.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_-1o2_Q3.0_0_1o2/
     u:6022   recl:        32   ext:                      pdvq2pq2.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_-1o2_Q3.0_0_1o2/
     u:5023   recl:      4352   ext:                        dq2pq3.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_-1o2_Q3.0_0_1o2/
     u:6023   recl:        32   ext:                      pdvq2pq3.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_-1o2_Q3.0_0_1o2/
     u:5021   recl:      4352   ext:                        dq2pq1.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_-1o2_Q3.0_0_1o2/
     u:6021   recl:        32   ext:                      pdvq2pq1.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_-1o2_Q3.0_0_1o2/
     u:5032   recl:      4352   ext:                        dq3pq2.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_-1o2_Q3.0_0_1o2/
     u:6032   recl:        32   ext:                      pdvq3pq2.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_-1o2_Q3.0_0_1o2/
     u:5033   recl:      4352   ext:                        dq3pq3.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_-1o2_Q3.0_0_1o2/
     u:6033   recl:        32   ext:                      pdvq3pq3.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_-1o2_Q3.0_0_1o2/
     u:5031   recl:      4352   ext:                        dq3pq1.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_-1o2_Q3.0_0_1o2/
     u:6031   recl:        32   ext:                      pdvq3pq1.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_-1o2_Q3.0_0_1o2/
     u:5012   recl:      4352   ext:                        dq1pq2.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_-1o2_Q3.0_0_1o2/
     u:6012   recl:        32   ext:                      pdvq1pq2.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_-1o2_Q3.0_0_1o2/
     u:5013   recl:      4352   ext:                        dq1pq3.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_-1o2_Q3.0_0_1o2/
     u:6013   recl:        32   ext:                      pdvq1pq3.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_-1o2_Q3.0_0_1o2/
     u:5011   recl:      4352   ext:                        dq1pq1.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_-1o2_Q3.0_0_1o2/
     u:6011   recl:        32   ext:                      pdvq1pq1.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_-1o2_Q3.0_0_1o2/

     ================= d3_init start
     alpha_pv:      1.7772

     ================= d3_init done

     ========== d3_check_permutations start
     Looking for equivalent permutations of q vectors
       Permutation 1 (123) has to be computed explicitly
       Permutation 2 (132) can be obtained from 1 (123) with c.c.
       Permutation 3 (213) has to be computed explicitly
       Permutation 4 (231) has to be computed explicitly
       Permutation 5 (312) can be obtained from 3 (213) with c.c.
       Permutation 6 (321) can be obtained from 4 (231) with c.c.
     3 inequivalent permutations were found

     ========== d3_check_permutations done
     D3_toten     :      3.00s CPU      3.11s WALL


     ================== add core start

     Adding derivative of core charge
     d3_add_rho_core   cpu time:     1.06 sec    Total time:        3.11 sec

     ================== add core done

     ===================================================
     = Nscf calculation of the perturbed wavefunctions =
     ===================================================

     Computing P_c^q1 |d^q1 psi_k>
         pert=    1     time taken/total=      0.9/      4.0 secs     av.it.  16.8
         pert=    2     time taken/total=      0.9/      4.8 secs     av.it.  17.1

     Skipping P_c^G |d^q1 psi_k-q1>
       --> already done as P_c^q1 |d^q1 psi_k+q1>

     Skipping P_c^-q1 |d^-q1 psi_k>
       --> already done as P_c^q1 |d^q1 psi_k+q1>

     Skipping P_c^G |d^-q1 psi_k+q1>
       --> already done as P_c^q1 |d^q1 psi_k+q1>

     Computing P_c^q2 |d^q2 psi_k>
         pert=    1     time taken/total=      0.3/      5.1 secs     av.it.  16.7
         pert=    2     time taken/total=      0.3/      5.4 secs     av.it.  16.8
         pert=    3     time taken/total=      0.6/      6.0 secs     av.it.  17.2
         pert=    4     time taken/total=      0.6/      6.6 secs     av.it.  17.3

     Computing P_c^G |d^q2 psi_k-q2>
         pert=    1     time taken/total=      0.3/      6.9 secs     av.it.  16.7
         pert=    2     time taken/total=      0.3/      7.2 secs     av.it.  16.8
         pert=    3     time taken/total=      0.6/      7.7 secs     av.it.  17.2
         pert=    4     time taken/total=      0.6/      8.3 secs     av.it.  17.3

     Computing <psi_k-q2 |d^-q2V| psi_k>

     Computing <psi_k |d^-q2V| psi_k+q2>

     Skipping <psi_k+q3 |d^q3V| psi_k>
       --> already done as <psi_k+q3 |d^q3V| psi_k+q1>

     Skipping <psi_k |d^q3V| psi_k-q3>
       --> already done as <psi_k+q1 |d^q3V| psi_k+q2>

     Skipping P_c^-q3 |d^-q3 psi_k>
       --> already done as P_c^q2 |d^q2 psi_k+q1>

     Skipping P_c^G |d^-q3 psi_k+q3>
       --> already done as P_c^q1 |d^q2 psi_k+q3>

     Computing <psi_k-q3 |d^q1V| psi_k+q2>

     Computing <psi_k-q2 |d^q1V| psi_k+q3>

     Skipping <psi_k-q3 |d^q2V| psi_k+q1>
       --> already done as <psi_k+q2 |d^q2V| psi_k+q1>

     Skipping <psi_k-q1 |d^q2V| psi_k+q3>
       --> already done as <psi_k+q1 |d^q2V| psi_k+q3>

     Skipping <psi_k-q2 |d^q3V| psi_k+q1>
       --> already done as <psi_k+q3 |d^q3V| psi_k+q1>

     Skipping <psi_k-q1 |d^q3V| psi_k+q2>
       --> already done as <psi_k+q1 |d^q3V| psi_k+q2>


     generate_dwfc   cpu time:     5.62 sec    Total time:        8.73 sec

     ================== nscf dpsi done =================


     ================== precomp start

     Pre-computing < Pc dpsi_(k+X)/du(-X)| dH/du(Y) | psi_k-Y >
     gen_dpsi1dv2psi     cpu time:     0.00 sec    Total time:        8.73 sec

     ================== precomp done

     ================== dpdvdp start

     Calculating the matrix elements <dpsi |dH |dpsi>
       <d^-q3 psi_k|d^q2  V|d^q1  psi_k>
       <d^-q3 psi_k|d^q1  V|d^q2  psi_k>
       <d^-q1 psi_k|d^q3  V|d^q2  psi_k>
     dpsi1dv2dpsi3 cpu time:     1.74 sec    Total time:       10.47 sec

     ================== dpdvdp done

     ================== dpdpdv start

     Calculating the matrix elements <dpsi|dpsi>< psi|dH|psi> 
       <d_-q3 psi_k+q3| d_q1 psi_k-q1> <psi_k-q1|d_q2 H|psi_k+q3>
       <d_-q3 psi_k+q3| d_q2 psi_k-q2> <psi_k-q2|d_q1 H|psi_k+q3>
       <d_-q1 psi_k+q1| d_q2 psi_k-q2> <psi_k-q2|d_q3 H|psi_k+q1>
     dpsi1dpsi2dv3 cpu time:     0.04 sec    Total time:       10.52 sec

     ================== dpdpdv done

     ================== dpd2v start

     Calculating the matrix elements <psi |d^2 v |dpsi>
       <d_q1 psi_k| d^2_(q2,q3) V|psi_k>
       <d_q2 psi_k| d^2_(q1,q3) V|psi_k>
     drhod2v       cpu time:     0.23 sec    Total time:       10.75 sec

     ================== dpd2v done

     =================== rho d3v start =================


     Calculating the matrix elements <psi |d^3v |psi>
     d3vrho        cpu time:     0.06 sec    Total time:       10.81 sec

     =================== rho d3v done ==================


     ================== ewald start

     Calculating the Ewald contribution

     Alpha used in Ewald sum =   1.01
     d3ionq        cpu time:     0.09 sec    Total time:       10.89 sec

     ================== ewald done

     ================ exc contrib start

     Calculating the exchange-correlation contribution
     d3_exc        cpu time:     0.03 sec    Total time:       10.92 sec

     ================ exc contrib done

     =============== computing D3 start

     Symmetrizing and writing the tensor to disc

     CALLing d3matrix
       * imposing hermiticity on idx 2,3
       * symmetrizing with 12 sym.ops.
       point #  1  : star #  1  perm #  1 ( 1 2 3 )
      -->FILD3DYN/anh_Q1.0_0_0_Q2.0_0_-1o2_Q3.0_0_1o2
       point #  2  : star #  2  perm #  1 ( 1 2 3 )
      -->FILD3DYN/anh_Q1.0_0_0_Q2.-1o2_0_0_Q3.1o2_0_0
       point #  3  : star #  3  perm #  1 ( 1 2 3 )
      -->FILD3DYN/anh_Q1.0_0_0_Q2.0_1o2_0_Q3.0_-1o2_0
       point #  4  : star #  4  perm #  1 ( 1 2 3 )
      -->FILD3DYN/anh_Q1.0_0_0_Q2.-1o2_-1o2_-1o2_Q3.1o2_1o2_1o2
     d3matrix      cpu time:     0.01 sec    Total time:       10.93 sec

     =============== computing D3 done

     ================== cleanup start

     D3TOTEN      :     10.48s CPU     10.93s WALL (       2 calls)
     --> wfc and dwfc
     nscf         :      1.06s CPU      1.09s WALL (       2 calls)
     generate_dwf :      6.29s CPU      6.64s WALL (       2 calls)
     --> matrix elements
     dpsi1dv2dpsi :      2.05s CPU      2.10s WALL (       4 calls)
     dpsi1dpsi2dv :      0.03s CPU      0.05s WALL (       4 calls)
     dq1rhodq23v  :      0.30s CPU      0.30s WALL (       3 calls)
     rhodq123v    :      0.11s CPU      0.11s WALL (       2 calls)
     d3ionq       :      0.17s CPU      0.17s WALL (       2 calls)
     d3_exc       :      0.05s CPU      0.05s WALL (       2 calls)
     d3matrix     :      0.02s CPU      0.02s WALL (       2 calls)
     --> total I/O
     davcio       :      0.06s CPU      0.07s WALL (   13803 calls)

     ================== cleanup done

     ===================================================
     =             Starting D3 calculation             =
     ===================================================
     =     triplet    3 (    3 of    5,  40% done)     =
     ===================================================
     =    q1 = (    0.000000   0.000000   0.000000 )   =
     =    q2 = (    0.000000  -1.000000   0.000000 )   =
     =    q3 = (   -0.000000   1.000000  -0.000000 )   =
     ===================================================
     Temporary directory set to:
       ./tmp//D3_Q1.0_0_0_Q2.0_-1o2_-1o2_Q3.0_1o2_1o2/
     SCF rho copied to D3 tmp dir
     Scanning for fildrho files...
         --> drho file for q1 found as 'drho.0_0_0'
         --> drho file for q2 found as 'drho.0_-1o2_-1o2'
         --> drho file for q3 found as 'drho.0_-1o2_-1o2'
     ================== setup started ==================
     Special cases for qs:
       q1 = G
       q2 = -q3
       q3 = -q2
       Symmetry operations:
         q1: 48  TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT
         q2: 12  TFTFFFTFTFFFTFFFFFFTFFFFFTTTFFFFTTTTTFFFFFFTFTFF
         q3: 12  TFTFFFTFTFFFTFFFFFFTFFFFFTTTFFFFTTTTTFFFFFFTFTFF
       Symmetry common to all q vectors:
             TFTFFFTFTFFFTFFFFFFTFFFFFTTTFFFFTTTTTFFFFFFTFTFF
         -->16 symmetry operation(s) have been found
 REMARK: q -> -q symmetry yet unsupported in d3q.x
         individual q --> -q operations: FFF
       Reading patterns and q-point for q1
       Reading patterns and q-point for q2
       Reading patterns and q-point for q3
         --> taking c.c. of patterns for q3
       Symmetry information for Gamma associated with q1

     Symmetry analysis done
     =================== setup done ====================



     =============== run_nscf_d3 start

     Starting non-scf calculation of ground state wavefunctions.

     WARNING: check_stop already initialized
       * has time reversal symmetry.
     Total number of kpoints:
       --> after reducing symmetry:    13
       --> after including k+/-q_i (kunit):    39 (3)

     --> output from 'electrons' appended to ./tmp//nscf_Q1.0_0_0_Q2.0_-1o2_-1o2_Q3.0_1o2_1o2.out

     Writing output data file silicon.save/

     =============== run_nscf_d3 done

     =============== allocate_d3 start

     =============== allocate_d3 done

     ============== openfile_drho start

     Opening files of charge density derivative.
         q1 --> opening: drho.0_0_0
         q2 --> opening: drho.0_-1o2_-1o2
         q3 --> not opening: drho.0_-1o2_-1o2

     ============== openfile_drho done

     ================ openfild3 start

     ================ openfild3 done
     u: 301   recl:     27648   ext:                     drho.0_0_0   tmp: FILDRHO/
     u: 302   recl:     27648   ext:               drho.0_-1o2_-1o2   tmp: FILDRHO/
     u:  20   recl:      4352   ext:                            wfc   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_-1o2_-1o2_Q3.0_1o2_1o2/
     u:5022   recl:      4352   ext:                        dq2pq2.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_-1o2_-1o2_Q3.0_1o2_1o2/
     u:6022   recl:        32   ext:                      pdvq2pq2.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_-1o2_-1o2_Q3.0_1o2_1o2/
     u:5023   recl:      4352   ext:                        dq2pq3.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_-1o2_-1o2_Q3.0_1o2_1o2/
     u:6023   recl:        32   ext:                      pdvq2pq3.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_-1o2_-1o2_Q3.0_1o2_1o2/
     u:5021   recl:      4352   ext:                        dq2pq1.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_-1o2_-1o2_Q3.0_1o2_1o2/
     u:6021   recl:        32   ext:                      pdvq2pq1.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_-1o2_-1o2_Q3.0_1o2_1o2/
     u:5032   recl:      4352   ext:                        dq3pq2.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_-1o2_-1o2_Q3.0_1o2_1o2/
     u:6032   recl:        32   ext:                      pdvq3pq2.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_-1o2_-1o2_Q3.0_1o2_1o2/
     u:5033   recl:      4352   ext:                        dq3pq3.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_-1o2_-1o2_Q3.0_1o2_1o2/
     u:6033   recl:        32   ext:                      pdvq3pq3.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_-1o2_-1o2_Q3.0_1o2_1o2/
     u:5031   recl:      4352   ext:                        dq3pq1.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_-1o2_-1o2_Q3.0_1o2_1o2/
     u:6031   recl:        32   ext:                      pdvq3pq1.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_-1o2_-1o2_Q3.0_1o2_1o2/
     u:5012   recl:      4352   ext:                        dq1pq2.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_-1o2_-1o2_Q3.0_1o2_1o2/
     u:6012   recl:        32   ext:                      pdvq1pq2.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_-1o2_-1o2_Q3.0_1o2_1o2/
     u:5013   recl:      4352   ext:                        dq1pq3.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_-1o2_-1o2_Q3.0_1o2_1o2/
     u:6013   recl:        32   ext:                      pdvq1pq3.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_-1o2_-1o2_Q3.0_1o2_1o2/
     u:5011   recl:      4352   ext:                        dq1pq1.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_-1o2_-1o2_Q3.0_1o2_1o2/
     u:6011   recl:        32   ext:                      pdvq1pq1.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_-1o2_-1o2_Q3.0_1o2_1o2/

     ================= d3_init start
     alpha_pv:      1.7772

     ================= d3_init done

     ========== d3_check_permutations start
     Looking for equivalent permutations of q vectors
       Permutation 1 (123) has to be computed explicitly
       Permutation 2 (132) can be obtained from 1 (123) with c.c.
       Permutation 3 (213) has to be computed explicitly
       Permutation 4 (231) has to be computed explicitly
       Permutation 5 (312) can be obtained from 3 (213) with c.c.
       Permutation 6 (321) can be obtained from 4 (231) with c.c.
     3 inequivalent permutations were found

     ========== d3_check_permutations done
     D3_toten     :     11.53s CPU     12.03s WALL


     ================== add core start

     Adding derivative of core charge
     d3_add_rho_core   cpu time:     1.10 sec    Total time:       12.03 sec

     ================== add core done

     ===================================================
     = Nscf calculation of the perturbed wavefunctions =
     ===================================================

     Computing P_c^q1 |d^q1 psi_k>
         pert=    1     time taken/total=      0.9/     12.9 secs     av.it.  16.8
         pert=    2     time taken/total=      0.9/     13.9 secs     av.it.  16.8

     Skipping P_c^G |d^q1 psi_k-q1>
       --> already done as P_c^q1 |d^q1 psi_k+q1>

     Skipping P_c^-q1 |d^-q1 psi_k>
       --> already done as P_c^q1 |d^q1 psi_k+q1>

     Skipping P_c^G |d^-q1 psi_k+q1>
       --> already done as P_c^q1 |d^q1 psi_k+q1>

     Computing P_c^q2 |d^q2 psi_k>
         pert=    1     time taken/total=      0.6/     14.5 secs     av.it.  16.9
         pert=    2     time taken/total=      0.6/     15.1 secs     av.it.  17.0
         pert=    3     time taken/total=      0.6/     15.7 secs     av.it.  16.7

     Computing P_c^G |d^q2 psi_k-q2>
         pert=    1     time taken/total=      0.7/     16.4 secs     av.it.  16.8
         pert=    2     time taken/total=      0.6/     17.0 secs     av.it.  17.0
         pert=    3     time taken/total=      0.6/     17.6 secs     av.it.  16.8

     Computing <psi_k-q2 |d^-q2V| psi_k>

     Computing <psi_k |d^-q2V| psi_k+q2>

     Skipping <psi_k+q3 |d^q3V| psi_k>
       --> already done as <psi_k+q3 |d^q3V| psi_k+q1>

     Skipping <psi_k |d^q3V| psi_k-q3>
       --> already done as <psi_k+q1 |d^q3V| psi_k+q2>

     Skipping P_c^-q3 |d^-q3 psi_k>
       --> already done as P_c^q2 |d^q2 psi_k+q1>

     Skipping P_c^G |d^-q3 psi_k+q3>
       --> already done as P_c^q1 |d^q2 psi_k+q3>

     Computing <psi_k-q3 |d^q1V| psi_k+q2>

     Computing <psi_k-q2 |d^q1V| psi_k+q3>

     Skipping <psi_k-q3 |d^q2V| psi_k+q1>
       --> already done as <psi_k+q2 |d^q2V| psi_k+q1>

     Skipping <psi_k-q1 |d^q2V| psi_k+q3>
       --> already done as <psi_k+q1 |d^q2V| psi_k+q3>

     Skipping <psi_k-q2 |d^q3V| psi_k+q1>
       --> already done as <psi_k+q3 |d^q3V| psi_k+q1>

     Skipping <psi_k-q1 |d^q3V| psi_k+q2>
       --> already done as <psi_k+q1 |d^q3V| psi_k+q2>


     generate_dwfc   cpu time:     6.09 sec    Total time:       18.13 sec

     ================== nscf dpsi done =================


     ================== precomp start

     Pre-computing < Pc dpsi_(k+X)/du(-X)| dH/du(Y) | psi_k-Y >
     gen_dpsi1dv2psi     cpu time:     0.00 sec    Total time:       18.13 sec

     ================== precomp done

     ================== dpdvdp start

     Calculating the matrix elements <dpsi |dH |dpsi>
       <d^-q3 psi_k|d^q2  V|d^q1  psi_k>
       <d^-q3 psi_k|d^q1  V|d^q2  psi_k>
       <d^-q1 psi_k|d^q3  V|d^q2  psi_k>
     dpsi1dv2dpsi3 cpu time:     1.78 sec    Total time:       19.91 sec

     ================== dpdvdp done

     ================== dpdpdv start

     Calculating the matrix elements <dpsi|dpsi>< psi|dH|psi> 
       <d_-q3 psi_k+q3| d_q1 psi_k-q1> <psi_k-q1|d_q2 H|psi_k+q3>
       <d_-q3 psi_k+q3| d_q2 psi_k-q2> <psi_k-q2|d_q1 H|psi_k+q3>
       <d_-q1 psi_k+q1| d_q2 psi_k-q2> <psi_k-q2|d_q3 H|psi_k+q1>
     dpsi1dpsi2dv3 cpu time:     0.04 sec    Total time:       19.95 sec

     ================== dpdpdv done

     ================== dpd2v start

     Calculating the matrix elements <psi |d^2 v |dpsi>
       <d_q1 psi_k| d^2_(q2,q3) V|psi_k>
       <d_q2 psi_k| d^2_(q1,q3) V|psi_k>
     drhod2v       cpu time:     0.22 sec    Total time:       20.17 sec

     ================== dpd2v done

     =================== rho d3v start =================


     Calculating the matrix elements <psi |d^3v |psi>
     d3vrho        cpu time:     0.06 sec    Total time:       20.23 sec

     =================== rho d3v done ==================


     ================== ewald start

     Calculating the Ewald contribution

     Alpha used in Ewald sum =   1.01
     d3ionq        cpu time:     0.09 sec    Total time:       20.31 sec

     ================== ewald done

     ================ exc contrib start

     Calculating the exchange-correlation contribution
     d3_exc        cpu time:     0.04 sec    Total time:       20.35 sec

     ================ exc contrib done

     =============== computing D3 start

     Symmetrizing and writing the tensor to disc

     CALLing d3matrix
       * imposing hermiticity on idx 2,3
       * symmetrizing with 16 sym.ops.
       point #  1  : star #  1  perm #  1 ( 1 2 3 )
      -->FILD3DYN/anh_Q1.0_0_0_Q2.0_-1o2_-1o2_Q3.0_1o2_1o2
       point #  2  : star #  2  perm #  1 ( 1 2 3 )
      -->FILD3DYN/anh_Q1.0_0_0_Q2.1o2_0_1o2_Q3.-1o2_0_-1o2
       point #  3  : star #  3  perm #  1 ( 1 2 3 )
      -->FILD3DYN/anh_Q1.0_0_0_Q2.1o2_1o2_0_Q3.-1o2_-1o2_0
     d3matrix      cpu time:     0.01 sec    Total time:       20.37 sec

     =============== computing D3 done

     ================== cleanup start

     D3TOTEN      :     19.47s CPU     20.37s WALL (       3 calls)
     --> wfc and dwfc
     nscf         :      1.92s CPU      1.99s WALL (       3 calls)
     generate_dwf :     12.06s CPU     12.73s WALL (       3 calls)
     --> matrix elements
     dpsi1dv2dpsi :      3.79s CPU      3.88s WALL (       7 calls)
     dpsi1dpsi2dv :      0.05s CPU      0.09s WALL (       7 calls)
     dq1rhodq23v  :      0.51s CPU      0.52s WALL (       5 calls)
     rhodq123v    :      0.17s CPU      0.17s WALL (       3 calls)
     d3ionq       :      0.26s CPU      0.26s WALL (       3 calls)
     d3_exc       :      0.08s CPU      0.09s WALL (       3 calls)
     d3matrix     :      0.03s CPU      0.03s WALL (       3 calls)
     --> total I/O
     davcio       :      0.10s CPU      0.13s WALL (   25066 calls)

     ================== cleanup done

     ===================================================
     =             Starting D3 calculation             =
     ===================================================
     =     triplet    4 (    4 of    5,  60% done)     =
     ===================================================
     =    q1 = (    0.500000  -0.500000   0.500000 )   =
     =    q2 = (   -0.500000  -0.500000  -0.500000 )   =
     =    q3 = (    0.000000   1.000000   0.000000 )   =
     ===================================================
     Temporary directory set to:
       ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     SCF rho copied to D3 tmp dir
     Scanning for fildrho files...
         --> drho file for q1 found as 'drho.0_0_-1o2'
         --> drho file for q2 found as 'drho.0_1o2_0'
         --> drho file for q3 found as 'drho.0_-1o2_-1o2'
     ================== setup started ==================
     Special cases for qs:
       q1 : no special case detected
       q2 : no special case detected
       q3 : no special case detected
       Symmetry operations:
         q1: 48  TTTTFFFFFFFFFFFFFFFTFFFFFTTTFFFFTTTTFFFFFFFFFFFF
         q2: 16  TTTTFFFFFFFFFFFFTFFFTTFFFFFFFTFFFFFFTTFFTFFFTFFF
         q3: 16  TTTTTTTTTTTTTTTTFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
       Symmetry common to all q vectors:
             TTTTFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
         --> 4 symmetry operation(s) have been found
 REMARK: q -> -q symmetry yet unsupported in d3q.x
         individual q --> -q operations: FFF
       Reading patterns and q-point for q1
       Reading patterns and q-point for q2
         --> drho of q2 ( -0.5000 -0.5000 -0.5000) was computed by ph.x for (  0.5000  0.5000  0.5000)
       Reading patterns and q-point for q3
         --> drho of q3 (  0.0000  1.0000  0.0000) was computed by ph.x for (  0.0000 -1.0000  0.0000)

     Symmetry analysis done
     =================== setup done ====================



     =============== run_nscf_d3 start

     Starting non-scf calculation of ground state wavefunctions.

     WARNING: check_stop already initialized
       * has time reversal symmetry.
     Total number of kpoints:
       --> after reducing symmetry:    24
       --> after including k+/-q_i (kunit):   168 (7)

     --> output from 'electrons' appended to ./tmp//nscf_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2.out

     Writing output data file silicon.save/

     =============== run_nscf_d3 done

     =============== allocate_d3 start

     =============== allocate_d3 done

     ============== openfile_drho start

     Opening files of charge density derivative.
       Translating drho from xq=(  0.5000  0.5000  0.5000) to xq=(  -0.50000  -0.50000  -0.50000) for point q2
         --> new drho stored to 'drho.0_1o2_0_newq2'
       Translating drho from xq=(  0.0000 -1.0000  0.0000) to xq=(   0.00000   1.00000   0.00000) for point q3
         --> new drho stored to 'drho.0_-1o2_-1o2_newq3'
         q1 --> opening: drho.0_0_-1o2
         q2 --> just opened: drho.0_1o2_0_newq2
         q3 --> just opened: drho.0_-1o2_-1o2_newq3

     ============== openfile_drho done

     ================ openfild3 start

     ================ openfild3 done
     u: 302   recl:     27648   ext:             drho.0_1o2_0_newq2   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u: 303   recl:     27648   ext:         drho.0_-1o2_-1o2_newq3   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u: 301   recl:     27648   ext:                  drho.0_0_-1o2   tmp: FILDRHO/
     u:  20   recl:      4352   ext:                            wfc   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5077   recl:      4352   ext:                      d-q3p-q3.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6077   recl:        32   ext:                    pdv-q3p-q3.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5078   recl:      4352   ext:                      d-q3p-q2.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6078   recl:        32   ext:                    pdv-q3p-q2.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5079   recl:      4352   ext:                      d-q3p-q1.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6079   recl:        32   ext:                    pdv-q3p-q1.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5070   recl:      4352   ext:                        d-q3pG.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6070   recl:        32   ext:                      pdv-q3pG.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5071   recl:      4352   ext:                       d-q3pq1.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6071   recl:        32   ext:                     pdv-q3pq1.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5072   recl:      4352   ext:                       d-q3pq2.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6072   recl:        32   ext:                     pdv-q3pq2.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5073   recl:      4352   ext:                       d-q3pq3.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6073   recl:        32   ext:                     pdv-q3pq3.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5087   recl:      4352   ext:                      d-q2p-q3.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6087   recl:        32   ext:                    pdv-q2p-q3.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5088   recl:      4352   ext:                      d-q2p-q2.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6088   recl:        32   ext:                    pdv-q2p-q2.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5089   recl:      4352   ext:                      d-q2p-q1.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6089   recl:        32   ext:                    pdv-q2p-q1.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5080   recl:      4352   ext:                        d-q2pG.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6080   recl:        32   ext:                      pdv-q2pG.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5081   recl:      4352   ext:                       d-q2pq1.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6081   recl:        32   ext:                     pdv-q2pq1.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5082   recl:      4352   ext:                       d-q2pq2.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6082   recl:        32   ext:                     pdv-q2pq2.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5083   recl:      4352   ext:                       d-q2pq3.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6083   recl:        32   ext:                     pdv-q2pq3.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5097   recl:      4352   ext:                      d-q1p-q3.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6097   recl:        32   ext:                    pdv-q1p-q3.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5098   recl:      4352   ext:                      d-q1p-q2.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6098   recl:        32   ext:                    pdv-q1p-q2.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5099   recl:      4352   ext:                      d-q1p-q1.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6099   recl:        32   ext:                    pdv-q1p-q1.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5090   recl:      4352   ext:                        d-q1pG.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6090   recl:        32   ext:                      pdv-q1pG.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5091   recl:      4352   ext:                       d-q1pq1.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6091   recl:        32   ext:                     pdv-q1pq1.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5092   recl:      4352   ext:                       d-q1pq2.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6092   recl:        32   ext:                     pdv-q1pq2.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5093   recl:      4352   ext:                       d-q1pq3.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6093   recl:        32   ext:                     pdv-q1pq3.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5007   recl:      4352   ext:                        dGp-q3.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6007   recl:        32   ext:                      pdvGp-q3.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5008   recl:      4352   ext:                        dGp-q2.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6008   recl:        32   ext:                      pdvGp-q2.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5009   recl:      4352   ext:                        dGp-q1.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6009   recl:        32   ext:                      pdvGp-q1.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5000   recl:      4352   ext:                          dGpG.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6000   recl:        32   ext:                        pdvGpG.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5001   recl:      4352   ext:                         dGpq1.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6001   recl:        32   ext:                       pdvGpq1.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5002   recl:      4352   ext:                         dGpq2.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6002   recl:        32   ext:                       pdvGpq2.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5003   recl:      4352   ext:                         dGpq3.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6003   recl:        32   ext:                       pdvGpq3.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5017   recl:      4352   ext:                       dq1p-q3.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6017   recl:        32   ext:                     pdvq1p-q3.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5018   recl:      4352   ext:                       dq1p-q2.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6018   recl:        32   ext:                     pdvq1p-q2.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5019   recl:      4352   ext:                       dq1p-q1.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6019   recl:        32   ext:                     pdvq1p-q1.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5010   recl:      4352   ext:                         dq1pG.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6010   recl:        32   ext:                       pdvq1pG.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5011   recl:      4352   ext:                        dq1pq1.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6011   recl:        32   ext:                      pdvq1pq1.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5012   recl:      4352   ext:                        dq1pq2.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6012   recl:        32   ext:                      pdvq1pq2.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5013   recl:      4352   ext:                        dq1pq3.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6013   recl:        32   ext:                      pdvq1pq3.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5027   recl:      4352   ext:                       dq2p-q3.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6027   recl:        32   ext:                     pdvq2p-q3.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5028   recl:      4352   ext:                       dq2p-q2.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6028   recl:        32   ext:                     pdvq2p-q2.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5029   recl:      4352   ext:                       dq2p-q1.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6029   recl:        32   ext:                     pdvq2p-q1.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5020   recl:      4352   ext:                         dq2pG.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6020   recl:        32   ext:                       pdvq2pG.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5021   recl:      4352   ext:                        dq2pq1.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6021   recl:        32   ext:                      pdvq2pq1.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5022   recl:      4352   ext:                        dq2pq2.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6022   recl:        32   ext:                      pdvq2pq2.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5023   recl:      4352   ext:                        dq2pq3.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6023   recl:        32   ext:                      pdvq2pq3.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5037   recl:      4352   ext:                       dq3p-q3.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6037   recl:        32   ext:                     pdvq3p-q3.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5038   recl:      4352   ext:                       dq3p-q2.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6038   recl:        32   ext:                     pdvq3p-q2.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5039   recl:      4352   ext:                       dq3p-q1.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6039   recl:        32   ext:                     pdvq3p-q1.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5030   recl:      4352   ext:                         dq3pG.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6030   recl:        32   ext:                       pdvq3pG.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5031   recl:      4352   ext:                        dq3pq1.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6031   recl:        32   ext:                      pdvq3pq1.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5032   recl:      4352   ext:                        dq3pq2.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6032   recl:        32   ext:                      pdvq3pq2.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:5033   recl:      4352   ext:                        dq3pq3.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/
     u:6033   recl:        32   ext:                      pdvq3pq3.   tmp: ./tmp//D3_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2/

     ================= d3_init start
     alpha_pv:      1.7772

     ================= d3_init done

     ========== d3_check_permutations start
     Looking for equivalent permutations of q vectors
       Permutation 1 (123) has to be computed explicitly
       Permutation 2 (132) has to be computed explicitly
       Permutation 3 (213) has to be computed explicitly
       Permutation 4 (231) has to be computed explicitly
       Permutation 5 (312) has to be computed explicitly
       Permutation 6 (321) has to be computed explicitly
     6 inequivalent permutations were found

     ========== d3_check_permutations done
     D3_toten     :     23.65s CPU     24.71s WALL


     ================== add core start

     Adding derivative of core charge
     d3_add_rho_core   cpu time:     4.34 sec    Total time:       24.71 sec

     ================== add core done

     ===================================================
     = Nscf calculation of the perturbed wavefunctions =
     ===================================================

     Computing P_c^q1 |d^q1 psi_k>
         pert=    1     time taken/total=      0.5/     25.3 secs     av.it.  17.0
         pert=    2     time taken/total=      0.6/     25.8 secs     av.it.  17.0
         pert=    3     time taken/total=      1.2/     27.0 secs     av.it.  17.4
         pert=    4     time taken/total=      1.2/     28.2 secs     av.it.  17.5

     Computing P_c^G |d^q1 psi_k-q1>
         pert=    1     time taken/total=      0.5/     28.7 secs     av.it.  17.0
         pert=    2     time taken/total=      0.6/     29.3 secs     av.it.  17.0
         pert=    3     time taken/total=      1.1/     30.4 secs     av.it.  17.5
         pert=    4     time taken/total=      1.2/     31.6 secs     av.it.  17.5

     Computing P_c^-q1 |d^-q1 psi_k>
         pert=    1     time taken/total=      0.6/     32.2 secs     av.it.  17.0
         pert=    2     time taken/total=      0.6/     32.8 secs     av.it.  17.0
         pert=    3     time taken/total=      1.2/     34.0 secs     av.it.  17.5
         pert=    4     time taken/total=      1.3/     35.2 secs     av.it.  17.5

     Computing P_c^G |d^-q1 psi_k+q1>
         pert=    1     time taken/total=      0.6/     35.8 secs     av.it.  17.0
         pert=    2     time taken/total=      0.6/     36.4 secs     av.it.  17.0
         pert=    3     time taken/total=      1.2/     37.6 secs     av.it.  17.5
         pert=    4     time taken/total=      1.2/     38.8 secs     av.it.  17.5

     Computing P_c^q2 |d^q2 psi_k>
         pert=    1     time taken/total=      0.6/     39.3 secs     av.it.  17.0
         pert=    2     time taken/total=      0.6/     39.9 secs     av.it.  17.0
         pert=    3     time taken/total=      1.1/     41.0 secs     av.it.  17.5
         pert=    4     time taken/total=      1.1/     42.2 secs     av.it.  17.5

     Computing P_c^G |d^q2 psi_k-q2>
         pert=    1     time taken/total=      0.6/     42.8 secs     av.it.  17.0
         pert=    2     time taken/total=      0.5/     43.3 secs     av.it.  17.0
         pert=    3     time taken/total=      1.1/     44.4 secs     av.it.  17.5
         pert=    4     time taken/total=      1.2/     45.6 secs     av.it.  17.5

     Computing P_c^-q2 |d^-q2 psi_k>
         pert=    1     time taken/total=      0.6/     46.2 secs     av.it.  17.0
         pert=    2     time taken/total=      0.6/     46.8 secs     av.it.  17.0
         pert=    3     time taken/total=      1.2/     48.0 secs     av.it.  17.5
         pert=    4     time taken/total=      1.2/     49.2 secs     av.it.  17.5

     Computing P_c^G |d^-q2 psi_k+q2>
         pert=    1     time taken/total=      0.6/     49.8 secs     av.it.  17.0
         pert=    2     time taken/total=      0.6/     50.4 secs     av.it.  17.0
         pert=    3     time taken/total=      1.2/     51.6 secs     av.it.  17.5
         pert=    4     time taken/total=      1.1/     52.7 secs     av.it.  17.5

     Computing P_c^q3 |d^q3 psi_k>
         pert=    1     time taken/total=      1.2/     53.9 secs     av.it.  17.4
         pert=    2     time taken/total=      1.1/     55.0 secs     av.it.  17.4
         pert=    3     time taken/total=      1.2/     56.2 secs     av.it.  17.2

     Computing P_c^G |d^q3 psi_k-q3>
         pert=    1     time taken/total=      1.3/     57.4 secs     av.it.  17.4
         pert=    2     time taken/total=      1.1/     58.6 secs     av.it.  17.5
         pert=    3     time taken/total=      1.2/     59.7 secs     av.it.  17.2

     Computing P_c^-q3 |d^-q3 psi_k>
         pert=    1     time taken/total=      1.1/     60.9 secs     av.it.  17.4
         pert=    2     time taken/total=      1.2/     62.1 secs     av.it.  17.4
         pert=    3     time taken/total=      1.1/     63.2 secs     av.it.  17.2

     Computing P_c^G |d^-q3 psi_k+q3>
         pert=    1     time taken/total=      1.1/     64.3 secs     av.it.  17.3
         pert=    2     time taken/total=      1.2/     65.5 secs     av.it.  17.5
         pert=    3     time taken/total=      1.1/     66.6 secs     av.it.  17.2

     Computing <psi_k-q3 |d^q1V| psi_k+q2>

     Computing <psi_k-q2 |d^q1V| psi_k+q3>

     Computing <psi_k-q3 |d^q2V| psi_k+q1>

     Computing <psi_k-q1 |d^q2V| psi_k+q3>

     Computing <psi_k-q2 |d^q3V| psi_k+q1>

     Computing <psi_k-q1 |d^q3V| psi_k+q2>


     generate_dwfc   cpu time:    43.19 sec    Total time:       67.90 sec

     ================== nscf dpsi done =================


     ================== precomp start

     Pre-computing < Pc dpsi_(k+X)/du(-X)| dH/du(Y) | psi_k-Y >
     gen_dpsi1dv2psi     cpu time:     0.00 sec    Total time:       67.90 sec

     ================== precomp done

     ================== dpdvdp start

     Calculating the matrix elements <dpsi |dH |dpsi>
       <d^-q3 psi_k|d^q2  V|d^q1  psi_k>
       <d^-q2 psi_k|d^q3  V|d^q1  psi_k>
       <d^-q3 psi_k|d^q1  V|d^q2  psi_k>
       <d^-q1 psi_k|d^q3  V|d^q2  psi_k>
       <d^-q2 psi_k|d^q1  V|d^q3  psi_k>
       <d^-q1 psi_k|d^q2  V|d^q3  psi_k>
     dpsi1dv2dpsi3 cpu time:     6.61 sec    Total time:       74.51 sec

     ================== dpdvdp done

     ================== dpdpdv start

     Calculating the matrix elements <dpsi|dpsi>< psi|dH|psi> 
       <d_-q3 psi_k+q3| d_q1 psi_k-q1> <psi_k-q1|d_q2 H|psi_k+q3>
       <d_-q2 psi_k+q2| d_q1 psi_k-q1> <psi_k-q1|d_q3 H|psi_k+q2>
       <d_-q3 psi_k+q3| d_q2 psi_k-q2> <psi_k-q2|d_q1 H|psi_k+q3>
       <d_-q1 psi_k+q1| d_q2 psi_k-q2> <psi_k-q2|d_q3 H|psi_k+q1>
       <d_-q2 psi_k+q2| d_q3 psi_k-q3> <psi_k-q3|d_q1 H|psi_k+q2>
       <d_-q1 psi_k+q1| d_q3 psi_k-q3> <psi_k-q3|d_q2 H|psi_k+q1>
     dpsi1dpsi2dv3 cpu time:     0.16 sec    Total time:       74.67 sec

     ================== dpdpdv done

     ================== dpd2v start

     Calculating the matrix elements <psi |d^2 v |dpsi>
       <d_q1 psi_k| d^2_(q2,q3) V|psi_k>
       <d_q2 psi_k| d^2_(q1,q3) V|psi_k>
       <d_q3 psi_k| d^2_(q1,q2) V|psi_k>
     drhod2v       cpu time:     0.62 sec    Total time:       75.29 sec

     ================== dpd2v done

     =================== rho d3v start =================


     Calculating the matrix elements <psi |d^3v |psi>
     d3vrho        cpu time:     0.11 sec    Total time:       75.40 sec

     =================== rho d3v done ==================


     ================== ewald start

     Calculating the Ewald contribution

     Alpha used in Ewald sum =   1.01
     d3ionq        cpu time:     0.09 sec    Total time:       75.48 sec

     ================== ewald done

     ================ exc contrib start

     Calculating the exchange-correlation contribution
     d3_exc        cpu time:     0.03 sec    Total time:       75.51 sec

     ================ exc contrib done

     =============== computing D3 start

     Symmetrizing and writing the tensor to disc

     CALLing d3matrix
       * symmetrizing with  4 sym.ops.
       point #  1  : star #  1  perm #  1 ( 1 2 3 )
      -->FILD3DYN/anh_Q1.0_0_-1o2_Q2.0_-1o2_0_Q3.0_1o2_1o2
       point #  2  : star #  2  perm #  1 ( 1 2 3 )
      -->FILD3DYN/anh_Q1.-1o2_0_0_Q2.1o2_1o2_1o2_Q3.0_-1o2_-1o2
       point #  3  : star #  3  perm #  1 ( 1 2 3 )
      -->FILD3DYN/anh_Q1.1o2_1o2_1o2_Q2.-1o2_0_0_Q3.0_-1o2_-1o2
       point #  4  : star #  4  perm #  1 ( 1 2 3 )
      -->FILD3DYN/anh_Q1.0_1o2_0_Q2.0_0_1o2_Q3.0_-1o2_-1o2
       point #  5  : star #  5  perm #  1 ( 1 2 3 )
      -->FILD3DYN/anh_Q1.1o2_1o2_1o2_Q2.0_-1o2_0_Q3.-1o2_0_-1o2
       point #  6  : star #  6  perm #  1 ( 1 2 3 )
      -->FILD3DYN/anh_Q1.-1o2_0_0_Q2.0_0_-1o2_Q3.1o2_0_1o2
       point #  7  : star #  7  perm #  1 ( 1 2 3 )
      -->FILD3DYN/anh_Q1.0_-1o2_0_Q2.1o2_1o2_1o2_Q3.-1o2_0_-1o2
       point #  8  : star #  8  perm #  1 ( 1 2 3 )
      -->FILD3DYN/anh_Q1.0_0_-1o2_Q2.1o2_1o2_1o2_Q3.-1o2_-1o2_0
       point #  9  : star #  9  perm #  1 ( 1 2 3 )
      -->FILD3DYN/anh_Q1.-1o2_0_0_Q2.0_-1o2_0_Q3.1o2_1o2_0
       point # 10  : star # 10  perm #  1 ( 1 2 3 )
      -->FILD3DYN/anh_Q1.0_-1o2_0_Q2.-1o2_0_0_Q3.1o2_1o2_0
       point # 11  : star # 11  perm #  1 ( 1 2 3 )
      -->FILD3DYN/anh_Q1.1o2_1o2_1o2_Q2.0_0_-1o2_Q3.-1o2_-1o2_0
       point # 12  : star # 12  perm #  1 ( 1 2 3 )
      -->FILD3DYN/anh_Q1.0_0_1o2_Q2.1o2_0_0_Q3.-1o2_0_-1o2
     d3matrix      cpu time:     0.04 sec    Total time:       75.55 sec

     =============== computing D3 done

     ================== cleanup start

     D3TOTEN      :     72.07s CPU     75.55s WALL (       4 calls)
     --> wfc and dwfc
     nscf         :      5.56s CPU      5.79s WALL (       4 calls)
     generate_dwf :     53.13s CPU     55.92s WALL (       4 calls)
     --> matrix elements
     dpsi1dv2dpsi :     10.23s CPU     10.49s WALL (      13 calls)
     dpsi1dpsi2dv :      0.11s CPU      0.25s WALL (      13 calls)
     dq1rhodq23v  :      1.11s CPU      1.14s WALL (       8 calls)
     rhodq123v    :      0.28s CPU      0.28s WALL (       4 calls)
     d3ionq       :      0.34s CPU      0.34s WALL (       4 calls)
     d3_exc       :      0.09s CPU      0.11s WALL (       4 calls)
     d3matrix     :      0.06s CPU      0.07s WALL (       4 calls)
     --> total I/O
     davcio       :      0.31s CPU      0.40s WALL (   68782 calls)

     ================== cleanup done

     ===================================================
     =             Starting D3 calculation             =
     ===================================================
     =     triplet    5 (    5 of    5,  80% done)     =
     ===================================================
     =    q1 = (    0.000000  -1.000000   0.000000 )   =
     =    q2 = (    1.000000   0.000000   0.000000 )   =
     =    q3 = (   -1.000000   1.000000  -0.000000 )   =
     ===================================================
     Temporary directory set to:
       ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     SCF rho copied to D3 tmp dir
     Scanning for fildrho files...
         --> drho file for q1 found as 'drho.0_-1o2_-1o2'
         --> drho file for q2 found as 'drho.1o2_0_1o2'
         --> drho file for q3 found as 'drho.-1o2_-1o2_0'
     ================== setup started ==================
     Special cases for qs:
       q1 : no special case detected
       q2 : no special case detected
       q3 : no special case detected
       Symmetry operations:
         q1: 12  TTTTTTTTTTTTTTTTFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
         q2: 12  TFTFTTTTTFFFFTFFFFFFFFFFFFFTFFFFTFFFTTTTFFFTFTFF
         q3: 16  TFTFTTTTTFFFFTFFFFFFFTFFTTTFTTTTFFFFFFFFFFFFFFFF
       Symmetry common to all q vectors:
             TFTFTTTTTFFFFTFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
         --> 8 symmetry operation(s) have been found
 REMARK: q -> -q symmetry yet unsupported in d3q.x
         individual q --> -q operations: FFF
       Reading patterns and q-point for q1
       Reading patterns and q-point for q2
         --> drho of q2 (  1.0000  0.0000  0.0000) was computed by ph.x for ( -1.0000  0.0000  0.0000)
       Reading patterns and q-point for q3
         --> drho of q3 ( -1.0000  1.0000 -0.0000) was computed by ph.x for (  0.0000  0.0000 -1.0000)

     Symmetry analysis done
     =================== setup done ====================



     =============== run_nscf_d3 start

     Starting non-scf calculation of ground state wavefunctions.

     WARNING: check_stop already initialized
       * has time reversal symmetry.
     Total number of kpoints:
       --> after reducing symmetry:    18
       --> after including k+/-q_i (kunit):   126 (7)

     --> output from 'electrons' appended to ./tmp//nscf_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1.out

     Writing output data file silicon.save/

     =============== run_nscf_d3 done

     =============== allocate_d3 start

     =============== allocate_d3 done

     ============== openfile_drho start

     Opening files of charge density derivative.
       Translating drho from xq=( -1.0000  0.0000  0.0000) to xq=(   1.00000   0.00000   0.00000) for point q2
         --> new drho stored to 'drho.1o2_0_1o2_newq2'
       Translating drho from xq=(  0.0000  0.0000 -1.0000) to xq=(  -1.00000   1.00000  -0.00000) for point q3
         --> new drho stored to 'drho.-1o2_-1o2_0_newq3'
         q1 --> opening: drho.0_-1o2_-1o2
         q2 --> just opened: drho.1o2_0_1o2_newq2
         q3 --> just opened: drho.-1o2_-1o2_0_newq3

     ============== openfile_drho done

     ================ openfild3 start

     ================ openfild3 done
     u: 302   recl:     27648   ext:           drho.1o2_0_1o2_newq2   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u: 303   recl:     27648   ext:         drho.-1o2_-1o2_0_newq3   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u: 301   recl:     27648   ext:               drho.0_-1o2_-1o2   tmp: FILDRHO/
     u:  20   recl:      4352   ext:                            wfc   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5077   recl:      4352   ext:                      d-q3p-q3.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6077   recl:        32   ext:                    pdv-q3p-q3.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5078   recl:      4352   ext:                      d-q3p-q2.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6078   recl:        32   ext:                    pdv-q3p-q2.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5079   recl:      4352   ext:                      d-q3p-q1.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6079   recl:        32   ext:                    pdv-q3p-q1.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5070   recl:      4352   ext:                        d-q3pG.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6070   recl:        32   ext:                      pdv-q3pG.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5071   recl:      4352   ext:                       d-q3pq1.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6071   recl:        32   ext:                     pdv-q3pq1.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5072   recl:      4352   ext:                       d-q3pq2.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6072   recl:        32   ext:                     pdv-q3pq2.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5073   recl:      4352   ext:                       d-q3pq3.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6073   recl:        32   ext:                     pdv-q3pq3.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5087   recl:      4352   ext:                      d-q2p-q3.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6087   recl:        32   ext:                    pdv-q2p-q3.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5088   recl:      4352   ext:                      d-q2p-q2.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6088   recl:        32   ext:                    pdv-q2p-q2.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5089   recl:      4352   ext:                      d-q2p-q1.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6089   recl:        32   ext:                    pdv-q2p-q1.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5080   recl:      4352   ext:                        d-q2pG.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6080   recl:        32   ext:                      pdv-q2pG.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5081   recl:      4352   ext:                       d-q2pq1.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6081   recl:        32   ext:                     pdv-q2pq1.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5082   recl:      4352   ext:                       d-q2pq2.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6082   recl:        32   ext:                     pdv-q2pq2.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5083   recl:      4352   ext:                       d-q2pq3.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6083   recl:        32   ext:                     pdv-q2pq3.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5097   recl:      4352   ext:                      d-q1p-q3.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6097   recl:        32   ext:                    pdv-q1p-q3.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5098   recl:      4352   ext:                      d-q1p-q2.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6098   recl:        32   ext:                    pdv-q1p-q2.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5099   recl:      4352   ext:                      d-q1p-q1.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6099   recl:        32   ext:                    pdv-q1p-q1.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5090   recl:      4352   ext:                        d-q1pG.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6090   recl:        32   ext:                      pdv-q1pG.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5091   recl:      4352   ext:                       d-q1pq1.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6091   recl:        32   ext:                     pdv-q1pq1.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5092   recl:      4352   ext:                       d-q1pq2.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6092   recl:        32   ext:                     pdv-q1pq2.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5093   recl:      4352   ext:                       d-q1pq3.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6093   recl:        32   ext:                     pdv-q1pq3.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5007   recl:      4352   ext:                        dGp-q3.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6007   recl:        32   ext:                      pdvGp-q3.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5008   recl:      4352   ext:                        dGp-q2.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6008   recl:        32   ext:                      pdvGp-q2.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5009   recl:      4352   ext:                        dGp-q1.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6009   recl:        32   ext:                      pdvGp-q1.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5000   recl:      4352   ext:                          dGpG.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6000   recl:        32   ext:                        pdvGpG.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5001   recl:      4352   ext:                         dGpq1.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6001   recl:        32   ext:                       pdvGpq1.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5002   recl:      4352   ext:                         dGpq2.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6002   recl:        32   ext:                       pdvGpq2.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5003   recl:      4352   ext:                         dGpq3.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6003   recl:        32   ext:                       pdvGpq3.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5017   recl:      4352   ext:                       dq1p-q3.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6017   recl:        32   ext:                     pdvq1p-q3.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5018   recl:      4352   ext:                       dq1p-q2.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6018   recl:        32   ext:                     pdvq1p-q2.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5019   recl:      4352   ext:                       dq1p-q1.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6019   recl:        32   ext:                     pdvq1p-q1.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5010   recl:      4352   ext:                         dq1pG.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6010   recl:        32   ext:                       pdvq1pG.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5011   recl:      4352   ext:                        dq1pq1.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6011   recl:        32   ext:                      pdvq1pq1.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5012   recl:      4352   ext:                        dq1pq2.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6012   recl:        32   ext:                      pdvq1pq2.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5013   recl:      4352   ext:                        dq1pq3.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6013   recl:        32   ext:                      pdvq1pq3.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5027   recl:      4352   ext:                       dq2p-q3.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6027   recl:        32   ext:                     pdvq2p-q3.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5028   recl:      4352   ext:                       dq2p-q2.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6028   recl:        32   ext:                     pdvq2p-q2.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5029   recl:      4352   ext:                       dq2p-q1.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6029   recl:        32   ext:                     pdvq2p-q1.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5020   recl:      4352   ext:                         dq2pG.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6020   recl:        32   ext:                       pdvq2pG.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5021   recl:      4352   ext:                        dq2pq1.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6021   recl:        32   ext:                      pdvq2pq1.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5022   recl:      4352   ext:                        dq2pq2.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6022   recl:        32   ext:                      pdvq2pq2.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5023   recl:      4352   ext:                        dq2pq3.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6023   recl:        32   ext:                      pdvq2pq3.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5037   recl:      4352   ext:                       dq3p-q3.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6037   recl:        32   ext:                     pdvq3p-q3.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5038   recl:      4352   ext:                       dq3p-q2.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6038   recl:        32   ext:                     pdvq3p-q2.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5039   recl:      4352   ext:                       dq3p-q1.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6039   recl:        32   ext:                     pdvq3p-q1.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5030   recl:      4352   ext:                         dq3pG.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6030   recl:        32   ext:                       pdvq3pG.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5031   recl:      4352   ext:                        dq3pq1.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6031   recl:        32   ext:                      pdvq3pq1.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5032   recl:      4352   ext:                        dq3pq2.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6032   recl:        32   ext:                      pdvq3pq2.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:5033   recl:      4352   ext:                        dq3pq3.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/
     u:6033   recl:        32   ext:                      pdvq3pq3.   tmp: ./tmp//D3_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1/

     ================= d3_init start
     alpha_pv:      1.7772

     ================= d3_init done

     ========== d3_check_permutations start
     Looking for equivalent permutations of q vectors
       Permutation 1 (123) has to be computed explicitly
       Permutation 2 (132) has to be computed explicitly
       Permutation 3 (213) has to be computed explicitly
       Permutation 4 (231) has to be computed explicitly
       Permutation 5 (312) has to be computed explicitly
       Permutation 6 (321) has to be computed explicitly
     6 inequivalent permutations were found

     ========== d3_check_permutations done
     D3_toten     :   1m15.24s CPU   1m18.91s WALL


     ================== add core start

     Adding derivative of core charge
     d3_add_rho_core   cpu time:     3.37 sec    Total time:       78.91 sec

     ================== add core done

     ===================================================
     = Nscf calculation of the perturbed wavefunctions =
     ===================================================

     Computing P_c^q1 |d^q1 psi_k>
         pert=    1     time taken/total=      0.9/     79.8 secs     av.it.  17.1
         pert=    2     time taken/total=      0.9/     80.6 secs     av.it.  17.1
         pert=    3     time taken/total=      0.8/     81.5 secs     av.it.  16.8

     Computing P_c^G |d^q1 psi_k-q1>
         pert=    1     time taken/total=      0.8/     82.3 secs     av.it.  17.0
         pert=    2     time taken/total=      0.9/     83.1 secs     av.it.  17.0
         pert=    3     time taken/total=      0.8/     84.0 secs     av.it.  16.9

     Computing P_c^-q1 |d^-q1 psi_k>
         pert=    1     time taken/total=      0.8/     84.8 secs     av.it.  17.1
         pert=    2     time taken/total=      0.9/     85.7 secs     av.it.  17.1
         pert=    3     time taken/total=      0.9/     86.5 secs     av.it.  16.8

     Computing P_c^G |d^-q1 psi_k+q1>
         pert=    1     time taken/total=      0.8/     87.4 secs     av.it.  17.1
         pert=    2     time taken/total=      0.9/     88.3 secs     av.it.  17.1
         pert=    3     time taken/total=      0.9/     89.1 secs     av.it.  16.9

     Computing P_c^q2 |d^q2 psi_k>
         pert=    1     time taken/total=      0.8/     90.0 secs     av.it.  17.1
         pert=    2     time taken/total=      0.9/     90.8 secs     av.it.  17.1
         pert=    3     time taken/total=      0.9/     91.7 secs     av.it.  16.8

     Computing P_c^G |d^q2 psi_k-q2>
         pert=    1     time taken/total=      0.9/     92.6 secs     av.it.  17.1
         pert=    2     time taken/total=      0.8/     93.4 secs     av.it.  17.0
         pert=    3     time taken/total=      0.8/     94.2 secs     av.it.  16.8

     Computing P_c^-q2 |d^-q2 psi_k>
         pert=    1     time taken/total=      0.9/     95.1 secs     av.it.  17.1
         pert=    2     time taken/total=      0.9/     95.9 secs     av.it.  17.1
         pert=    3     time taken/total=      0.8/     96.8 secs     av.it.  16.8

     Computing P_c^G |d^-q2 psi_k+q2>
         pert=    1     time taken/total=      0.9/     97.6 secs     av.it.  17.1
         pert=    2     time taken/total=      0.8/     98.5 secs     av.it.  17.0
         pert=    3     time taken/total=      0.8/     99.3 secs     av.it.  16.8

     Computing P_c^q3 |d^q3 psi_k>
         pert=    1     time taken/total=      0.8/    100.1 secs     av.it.  16.9
         pert=    2     time taken/total=      0.9/    101.0 secs     av.it.  17.1
         pert=    3     time taken/total=      0.8/    101.8 secs     av.it.  16.8

     Computing P_c^G |d^q3 psi_k-q3>
         pert=    1     time taken/total=      0.8/    102.6 secs     av.it.  17.1
         pert=    2     time taken/total=      0.8/    103.5 secs     av.it.  17.0
         pert=    3     time taken/total=      0.8/    104.3 secs     av.it.  16.7

     Computing P_c^-q3 |d^-q3 psi_k>
         pert=    1     time taken/total=      0.8/    105.1 secs     av.it.  16.9
         pert=    2     time taken/total=      0.8/    106.0 secs     av.it.  17.1
         pert=    3     time taken/total=      0.8/    106.8 secs     av.it.  16.8

     Computing P_c^G |d^-q3 psi_k+q3>
         pert=    1     time taken/total=      0.8/    107.7 secs     av.it.  17.1
         pert=    2     time taken/total=      0.9/    108.5 secs     av.it.  17.2
         pert=    3     time taken/total=      0.8/    109.4 secs     av.it.  16.8

     Computing <psi_k-q3 |d^q1V| psi_k+q2>

     Computing <psi_k-q2 |d^q1V| psi_k+q3>

     Computing <psi_k-q3 |d^q2V| psi_k+q1>

     Computing <psi_k-q1 |d^q2V| psi_k+q3>

     Computing <psi_k-q2 |d^q3V| psi_k+q1>

     Computing <psi_k-q1 |d^q3V| psi_k+q2>


     generate_dwfc   cpu time:    31.36 sec    Total time:      110.27 sec

     ================== nscf dpsi done =================


     ================== precomp start

     Pre-computing < Pc dpsi_(k+X)/du(-X)| dH/du(Y) | psi_k-Y >
     gen_dpsi1dv2psi     cpu time:     0.00 sec    Total time:      110.27 sec

     ================== precomp done

     ================== dpdvdp start

     Calculating the matrix elements <dpsi |dH |dpsi>
       <d^-q3 psi_k|d^q2  V|d^q1  psi_k>
       <d^-q2 psi_k|d^q3  V|d^q1  psi_k>
       <d^-q3 psi_k|d^q1  V|d^q2  psi_k>
       <d^-q1 psi_k|d^q3  V|d^q2  psi_k>
       <d^-q2 psi_k|d^q1  V|d^q3  psi_k>
       <d^-q1 psi_k|d^q2  V|d^q3  psi_k>
     dpsi1dv2dpsi3 cpu time:     4.97 sec    Total time:      115.24 sec

     ================== dpdvdp done

     ================== dpdpdv start

     Calculating the matrix elements <dpsi|dpsi>< psi|dH|psi> 
       <d_-q3 psi_k+q3| d_q1 psi_k-q1> <psi_k-q1|d_q2 H|psi_k+q3>
       <d_-q2 psi_k+q2| d_q1 psi_k-q1> <psi_k-q1|d_q3 H|psi_k+q2>
       <d_-q3 psi_k+q3| d_q2 psi_k-q2> <psi_k-q2|d_q1 H|psi_k+q3>
       <d_-q1 psi_k+q1| d_q2 psi_k-q2> <psi_k-q2|d_q3 H|psi_k+q1>
       <d_-q2 psi_k+q2| d_q3 psi_k-q3> <psi_k-q3|d_q1 H|psi_k+q2>
       <d_-q1 psi_k+q1| d_q3 psi_k-q3> <psi_k-q3|d_q2 H|psi_k+q1>
     dpsi1dpsi2dv3 cpu time:     0.12 sec    Total time:      115.35 sec

     ================== dpdpdv done

     ================== dpd2v start

     Calculating the matrix elements <psi |d^2 v |dpsi>
       <d_q1 psi_k| d^2_(q2,q3) V|psi_k>
       <d_q2 psi_k| d^2_(q1,q3) V|psi_k>
       <d_q3 psi_k| d^2_(q1,q2) V|psi_k>
     drhod2v       cpu time:     0.45 sec    Total time:      115.81 sec

     ================== dpd2v done

     =================== rho d3v start =================


     Calculating the matrix elements <psi |d^3v |psi>
     d3vrho        cpu time:     0.08 sec    Total time:      115.89 sec

     =================== rho d3v done ==================


     ================== ewald start

     Calculating the Ewald contribution

     Alpha used in Ewald sum =   1.01
     d3ionq        cpu time:     0.08 sec    Total time:      115.97 sec

     ================== ewald done

     ================ exc contrib start

     Calculating the exchange-correlation contribution
     d3_exc        cpu time:     0.03 sec    Total time:      115.99 sec

     ================ exc contrib done

     =============== computing D3 start

     Symmetrizing and writing the tensor to disc

     CALLing d3matrix
       * symmetrizing with  8 sym.ops.
       point #  1  : star #  1  perm #  1 ( 1 2 3 )
      -->FILD3DYN/anh_Q1.0_-1o2_-1o2_Q2.-1o2_0_-1o2_Q3.1o2_1o2_1
       point #  2  : star #  2  perm #  1 ( 1 2 3 )
      -->FILD3DYN/anh_Q1.0_1o2_1o2_Q2.-1o2_-1o2_0_Q3.1o2_0_-1o2
       point #  3  : star #  3  perm #  1 ( 1 2 3 )
      -->FILD3DYN/anh_Q1.1o2_0_1o2_Q2.1o2_1o2_0_Q3.-1_-1o2_-1o2
       point #  4  : star #  4  perm #  1 ( 1 2 3 )
      -->FILD3DYN/anh_Q1.1o2_1o2_0_Q2.0_-1o2_-1o2_Q3.-1o2_0_1o2
       point #  5  : star #  5  perm #  1 ( 1 2 3 )
      -->FILD3DYN/anh_Q1.-1o2_0_-1o2_Q2.0_-1o2_-1o2_Q3.1o2_1o2_1
       point #  6  : star #  6  perm #  1 ( 1 2 3 )
      -->FILD3DYN/anh_Q1.-1o2_-1o2_0_Q2.1o2_0_1o2_Q3.0_1o2_-1o2
     d3matrix      cpu time:     0.02 sec    Total time:      116.01 sec

     =============== computing D3 done

     ================== cleanup start

     ================== cleanup done

     D3TOTEN      :    110.35s CPU    116.02s WALL (       5 calls)

      NSCF calculation of ground-state wfcs
     init_run     :      0.28s CPU      0.28s WALL (       5 calls)
     electrons    :      7.94s CPU      8.30s WALL (       5 calls)
     c_bands      :      7.94s CPU      8.30s WALL (       5 calls)
     cegterg      :      6.88s CPU      7.18s WALL (     380 calls)

      NSCF calculation of perturbed wfcs
     generate_dwf :     82.75s CPU     87.28s WALL (       5 calls)
     solve_linter :     82.74s CPU     87.22s WALL (     162 calls)
     ortho        :      0.07s CPU      0.08s WALL (    3540 calls)
     cgsolve      :     74.67s CPU     78.68s WALL (    3540 calls)

     ch_psi       :     73.33s CPU     77.26s WALL (   67257 calls)
     h_psiq       :     69.15s CPU     72.86s WALL (   67257 calls)

     firstfft     :     29.02s CPU     30.59s WALL (  249024 calls)
     secondfft    :     29.54s CPU     31.08s WALL (  249024 calls)

      D3 setup and pre-calculations
     d3_setup     :      0.00s CPU      0.01s WALL (       5 calls)
     d3_setup_noq :      0.00s CPU      0.00s WALL (       1 calls)
     d3_init      :      1.41s CPU      1.43s WALL (       5 calls)

      D3 matrix elements
     dpsi1dv2dpsi :     15.04s CPU     15.46s WALL (      19 calls)
     dpsi1dpsi2dv :      0.16s CPU      0.36s WALL (      19 calls)
     dq1rhodq23v  :      1.53s CPU      1.59s WALL (      11 calls)
     rhodq123v    :      0.36s CPU      0.36s WALL (       5 calls)
     d3ionq       :      0.42s CPU      0.43s WALL (       5 calls)
     d3_exc       :      0.12s CPU      0.14s WALL (       5 calls)
     d3matrix     :      0.08s CPU      0.09s WALL (       5 calls)

      Input/output
     drho_add_pha :      0.00s CPU      0.00s WALL (      24 calls)
     drho_change_ :      0.00s CPU      0.00s WALL (       4 calls)
     read_drho    :      0.13s CPU      0.15s WALL (    1776 calls)
     davcio       :      0.46s CPU      0.59s WALL (  101248 calls)

      General routines
     calbec       :      2.75s CPU      2.89s WALL (  140275 calls)

      Parallel routines
